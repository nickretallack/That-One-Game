// Generated by CoffeeScript 1.3.3
(function() {
  var Board, Tile, random_choice, tile_count, tile_size, tile_types;

  tile_size = 40;

  tile_count = {
    x: 10,
    y: 9
  };

  tile_types = "burger hotdog pizza".split(' ');

  random_choice = function(choices) {
    var index;
    index = Math.floor(Math.random() * choices.length) % choices.length;
    return choices[index];
  };

  Tile = (function() {

    function Tile(_arg) {
      this.position = _arg.position, this.board = _arg.board, this.type = _arg.type;
      _.bindAll(this);
      this.element = $("<div class=\"positioned tile " + this.type + "\"></div>");
      this.element.css({
        position: 'absolute',
        width: "" + tile_size + "px",
        height: "" + tile_size + "px"
      });
      this.re_position();
      this.element.on('click', this.clicked);
    }

    Tile.prototype.re_position = function() {
      return this.element.css({
        left: this.position.x * tile_size,
        bottom: this.position.y * tile_size
      });
    };

    Tile.prototype.position_key = function() {
      return "" + this.position.x + "-" + this.position.y;
    };

    Tile.prototype.clicked = function() {};

    return Tile;

  })();

  Board = (function() {

    function Board(_arg) {
      var tile, x, y, _i, _j, _ref, _ref1;
      this.element = _arg.element;
      this.element.css({
        width: "" + (tile_count.x * tile_size) + "px",
        height: "" + (tile_count.y * tile_size) + "px"
      });
      this.tiles = {};
      for (x = _i = 0, _ref = tile_count.x; 0 <= _ref ? _i < _ref : _i > _ref; x = 0 <= _ref ? ++_i : --_i) {
        for (y = _j = 0, _ref1 = tile_count.y; 0 <= _ref1 ? _j < _ref1 : _j > _ref1; y = 0 <= _ref1 ? ++_j : --_j) {
          tile = new Tile({
            position: {
              x: x,
              y: y
            },
            board: this,
            type: random_choice(tile_types)
          });
          this.register_tile(tile);
          this.element.append(tile.element);
        }
      }
    }

    Board.prototype.register_tile = function(tile) {
      return this.tiles[tile.position_key()] = tile;
    };

    Board.prototype.unregister_tile = function(tile) {
      return delete this.tiles[tile.position_key()];
    };

    Board.prototype.move_tile = function(tile, position) {
      unregister_tile(tile);
      tile.position = position;
      return register_tile(tile);
    };

    return Board;

  })();

  $(function() {
    return new Board({
      element: $('#game')
    });
  });

}).call(this);
